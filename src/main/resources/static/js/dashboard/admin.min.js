var playPie;var jobPie;$(document).ready(function(){$('input:radio[name="playbookChecked"]').change(function(){loadPieChartPlaybook()});$('input:radio[name="jobChecked"]').change(function(){loadPieChartJob()});statisticPlaybookByStatus();statisticJobByStatus();let $fixedHeader=$("#header-fixed");a();function a(){$fixedHeader.empty();let $header=$("#job_assign_tbl > thead").clone();$("#job_assign_tbl > thead th").each(function(b){let width=$(this).outerWidth();$header.find("th").eq(b).css("width",width)});$fixedHeader.append($header).css("width",$("#job_assign_tbl > thead").outerWidth())}$(window).resize(function(){a()});loadPieChartPlaybook();loadPieChartJob();$("#tbl_workflow_static").on("click","#workflowId",function(){var b=$(this).attr("data-id");if(b===""){Swal.fire({text:"Require to select the workflow before viewing in detail",type:"error",timer:2000,showConfirmButton:false});return}$(".contentWorkflowDetail").empty();$.ajax({type:"GET",url:"/nera/api/get-image-workflow",data:{id:b},success:function(c){if(c!=""){$(".contentWorkflowDetail").append("");$(".contentWorkflowDetail").append('<img src="data:image/png;base64, '+c+'">')}else{Swal.fire({title:"Workflow Detail",text:"Load detail failed",type:"error",timer:3000,showConfirmButton:false})}$("#viewDetailImageWorkflow").modal("show")},error:function(c){Swal.fire({title:"Workflow Detail",text:"Load detail failed",type:"error",timer:3000,showConfirmButton:false})}})})});function loadPieChartPlaybook(){let type=$("input[name='playbookChecked']:checked").val();$.ajax({type:"GET",url:"/nera/dashboard/api/statistic-playbook-by-status-pie-chart?type="+type,success:function(a){playPie=a;google.charts.setOnLoadCallback(drawChart)}})}function loadPieChartJob(){let type=$("input[name='jobChecked']:checked").val();$.ajax({type:"GET",url:"/nera/dashboard/api/statistic-job-by-status-pie-chart?type="+type,success:function(a){jobPie=a;google.charts.setOnLoadCallback(drawChart1)}})}function appendWorkflow(b,c,a){$("#up_coming_task_tbl > tbody:last").append('<tr class="text-wf"><td>'+b+"</td><td>"+c+"</td><td>"+a+"</td></tr>")}function statisticJobByStatus(){$.ajax({type:"GET",url:"/nera/dashboard/api/statistic-job-by-status",success:function(a){$("#job_pending_status").text(a["Pending for Acceptance"]);$("#job_accept_status").text(a.Accepted);$("#job_reject_status").text(a.Rejected);$("#job_exec_status").text(a.Executing);$("#job_complete_status").text(a["Finished (Approved)"]+a["Finished (Rejected)"]);$("#job_stop_status").text(a["Finished (Stopped)"]);$("#job_fail_status").text(a["Finished (Failed)"])}})}function statisticPlaybookByStatus(){$.ajax({type:"GET",url:"/nera/dashboard/api/statistic-playbook-by-status",success:function(a){$("#new_status").text(a[1]);$("#pending_status").text(a[4]);$("#approved_status").text(a[2]);$("#reject_status").text(a[3])}})}function getWorkflowStatistic(){$.ajax({type:"GET",url:"/nera/dashboard/api/statistic-workflow",success:function(a){let raw=a;for(let i=0;i<raw.length;i++){appendWorkflow(raw[i].name,raw[i].usage,raw[i].timView)}}})}function getJobExecToDoToday(){$("#up_coming_task_tbl tbody tr").remove();getJobExecToDo(1)}function getJobExecToDoOnWeek(){$("#up_coming_task_tbl tbody tr").remove();getJobExecToDo(2)}function getJobExecToDoOnMonth(){$("#up_coming_task_tbl tbody tr").remove();getJobExecToDo(3)}google.charts.load("current",{packages:["corechart"]});function drawChart(){var c=google.visualization.arrayToDataTable([["Task","Hours per Day"],["New",playPie[1]],["Pending Approval",playPie[4]],["Approved",playPie[2]],["Rejected",playPie[3]]],false);var a={sliceVisibilityThreshold:0,width:"100%",responsive:true,chartArea:{width:500,height:500,top:20,left:10,bottom:10},legend:{alignment:"center"}};var b=new google.visualization.PieChart(document.getElementById("piechart"));b.draw(c,a)}function drawChart1(){var c=google.visualization.arrayToDataTable([["Task","Hours per Day"],["Pending Acceptance",jobPie["Pending for Acceptance"]],["Accepted",jobPie.Accepted],["Rejected",jobPie.Rejected],["Executing",jobPie.Executing],["Completed",jobPie["Finished (Approved)"]+jobPie["Finished (Rejected)"]],["Stopped",jobPie["Finished (Stopped)"]],["Failed",jobPie["Finished (Failed)"]]],false);var a={sliceVisibilityThreshold:0,width:"100%",responsive:true,chartArea:{width:500,height:500,top:20,bottom:10},legend:{alignment:"center"}};var b=new google.visualization.PieChart(document.getElementById("piechart1"));b.draw(c,a)};